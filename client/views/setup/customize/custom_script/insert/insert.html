<template name="CustomScriptInsert">
    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-12">
			<table cellspacing="0" cellpadding="0" border="0" style="width: 100%;">
				<tr>
					<td>		
						<div style="vertical-align: middle;">
							<h2>
								<div class="pull-left">New Custom Script 1</div>
								<span class="indicator-orange indicator-text">Not Saved</span>
							</h2>
						</div>
					</td>
					<td>
						<div class="page-heading-logo">
							<span class="logo-symbol"><b><i class="fa fa-sitemap"></i></b></span>
							<span class="logo-text"><b> GridERP</b></span>
						</div>
					</td>
				</tr>
				<tr style="height: 30px;">
					<td>
						<div class="breadcrumbs">
							{{> breadcrumb}}
						</div>
					</td>
					<td>&nbsp;
					</td>
				</tr>
			</table>
        </div>
    </div>
	<div class="wrapper wrapper-content" style="padding-top:25px;">
		<div class="row">
			<div class="col-md-12">
				<div class="ibox float-e-margins">
					<div class="ibox-content just-top">
						{{> CustomScriptInsertInsertForm}}
					</div>
				</div>
			</div>
		</div>
	</div>
</template>

<template name="CustomScriptInsertInsertForm">
	<div id="custom-script-insert-insert-form" class="">
		<form role="form">
			{{#if errorMessage}}
			<div class="alert alert-warning">
				{{errorMessage}}
			</div>
			{{/if}}		
		
			{{#if infoMessage}}
			<div class="alert alert-success">
				{{infoMessage}}
			</div>
			{{/if}}
			<!--<div class="form-group  field-name">
				<label for="name">
					Name
				</label>
				<div class="input-div">
					<input type="text" name="name" value="" class="form-control" autofocus="autofocus" required="required">
					<span id="help-text" class="help-block">
					</span>
					<span id="error-text" class="help-block">
					</span>
				</div>
			</div>
			<div class="form-group  field-dt">
				<label for="dt">
					DocType
				</label>
				<div class="input-div">
					<input type="text" name="dt" value="" class="form-control">
					<span id="help-text" class="help-block">
					</span>
					<span id="error-text" class="help-block">
					</span>
				</div>
			</div>
			<div class="form-group  field-script-type">
				<label for="script_type">
					Script Type
				</label>
				<div class="input-div">
					<input type="text" name="script_type" value="" class="form-control">
					<span id="help-text" class="help-block">
					</span>
					<span id="error-text" class="help-block">
					</span>
				</div>
			</div>-->
			<div class="layout-main-section">
				<div class="form-inner-toolbar hide"></div>
				<div class="page-form row hide"></div>
				<div>
					<div>
						<div class="form-layout">
						    <div class="form-dashboard" style="display: none;">
						        <div class="row" style="padding: 15px 30px;"></div>
						    </div>
						    <div class="form-page">
						        <div class="row form-section visible-section">
						            <div class="section-body">
						                <div class="form-column col-sm-12">
						                    <form>
						                        <div class="griderp-control input-max-width" data-fieldtype="Link" data-fieldname="dt">
						                            <div class="form-group" style="margin: 0px"> <label class="control-label" style="padding-right: 0px;">DocType</label>
						                                <div class="control-input-wrapper">
						                                    <div class="control-input">
						                                        <div class="link-field ui-front" style="position: relative;"> <input type="text" class="input-with-feedback form-control ui-autocomplete-input" data-fieldtype="Link" data-fieldname="dt" placeholder="" data-doctype="Custom Script" autocomplete="off"> <span class="link-btn">    <a class="btn-open no-decoration" title="Open Link">     <i class="icon-link"></i></a>   </span>
						                                            <ul class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content" id="ui-id-5" tabindex="0" style="display: none;"></ul>
						                                        </div>
						                                    </div>
						                                    <div class="control-value like-disabled-input" style="display: none;"></div>
						                                    <p class="help-box small text-muted hidden-xs"></p>
						                                </div>
						                            </div>
						                        </div>
						                        <div class="griderp-control input-max-width hide-control" data-fieldtype="Select" data-fieldname="script_type">
						                            <div class="form-group" style="margin: 0px"> <label class="control-label" style="padding-right: 0px;"></label>
						                                <div class="control-input-wrapper">
						                                    <div class="control-input"></div>
						                                    <div class="control-value like-disabled-input" style="display: none;"></div>
						                                    <p class="help-box small text-muted hidden-xs"></p>
						                                </div>
						                            </div>
						                        </div>
						                        <div class="griderp-control" data-fieldtype="Code" data-fieldname="script">
						                            <div class="form-group" style="margin: 0px"> <label class="control-label" style="padding-right: 0px;">Script</label>
						                                <div class="control-input-wrapper">
						                                    <div class="control-input"><textarea type="text" class="input-with-feedback form-control" data-fieldtype="Code" data-fieldname="script" placeholder="" data-doctype="Custom Script" style="height: 400px; font-family: Monaco, 'Courier New', monospace;"></textarea></div>
						                                    <div class="control-value like-disabled-input for-description" style="display: none;"><pre></pre></div>
						                                    <p class="help-box small text-muted hidden-xs"></p>
						                                </div>
						                            </div>
						                        </div>
						                        <div class="griderp-control" data-fieldtype="HTML" data-fieldname="sample">
						                            <h3>Custom Script Help</h3>
						                            <p>Custom Scripts are executed only on the client-side (i.e. in Forms). Here are some examples to get you started</p>
						                            <pre><code>

// fetch local_tax_no on selection of customer
// cur_frm.add_fetch(link_field, source_fieldname, target_fieldname);
cur_frm.add_fetch("customer", "local_tax_no", "local_tax_no");

// additional validation on dates
griderp.ui.form.on("Task", "validate", function(frm) {
	if (frm.doc.from_date &lt; get_today()) {
		msgprint("You can not select past date in From Date");
		validated = false;
	}
});

// make a field read-only after saving
griderp.ui.form.on("Task", {
	refresh: function(frm) {
		// use the __islocal value of doc, to check if the doc is saved or not
		frm.set_df_property("myfield", "read_only", frm.doc.__islocal ? 0 : 1);
	}
});

// additional permission check
griderp.ui.form.on("Task", {
	validate: function(frm) {
		if(user=="user1@example.com" &amp;&amp; frm.doc.purpose!="Material Receipt") {
			msgprint("You are only allowed Material Receipt");
			validated = false;
		}
	}
});

// calculate sales incentive
griderp.ui.form.on("Sales Invoice", {
	validate: function(frm) {
		// calculate incentives for each person on the deal
		total_incentive = 0
		$.each(frm.doc.sales_team), function(i, d) {

			// calculate incentive
			var incentive_percent = 2;
			if(frm.doc.base_grand_total &gt; 400) incentive_percent = 4;

			// actual incentive
			d.incentives = flt(frm.doc.base_grand_total) * incentive_percent / 100;
			total_incentive += flt(d.incentives)
		});

		frm.doc.total_incentive = total_incentive;
	}
})

</code>
</pre></div>
						                    </form>
						                </div>
						            </div>
						        </div>
						    </div>
						</div>
					</div>
					<div class="pull-right scroll-to-top" style="padding-top:30px;"> <a onclick="scroll(0,0)"><i class="fa fa-chevron-up text-muted"></i></a> </div>
				</div>
			</div>
			<div class="just-top">
				<div class="submit-div">
					<button id="form-submit-button" class="btn btn-success" type="submit">
						<span class="fa fa-check">
						</span>
						Save
					</button>
					<a href="#" id="form-cancel-button" class="btn btn-default">
						Cancel
					</a>
				</div>
			</div>
		</form>
	</div>
</template>

